// ==UserScript==
// @name                GoogleGPT ðŸ¤–
// @description         Adds ChatGPT answers to Google Search sidebar (powered by GPT-4!)  
// @description:af      Voeg ChatGPT-antwoorde by Google Soek kantbalk by (aangedryf deur GPT-4!)
// @description:am      á‹¨ChatGPT áˆ˜áˆáˆµáŠ“á‹ˆáˆ­á‰ƒáˆˆá‰½ áŠ¥áˆ­áˆµá‹ŽáŠ• á‰ Google á‹¨á‰°á‹ˆáˆ°áŠ‘ áŒˆáŒ½á‰³á‹Žá‰½áŠ• (á‰°áŒá‰£áˆ­ á‰ GPT-4!) á‹­áŒ¨áˆáˆ©  
// @description:ar      ÙŠØ¶ÙŠÙ Ø¥Ø¬Ø§Ø¨Ø§Øª ChatGPT Ø¥Ù„Ù‰ Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ÙÙŠ Google (Ù…Ø¯Ø¹ÙˆÙ… Ø¨ÙˆØ§Ø³Ø·Ø© GPT-4!)
// @description:az      ChatGPT cavablarÄ±nÄ± Google AxtarÄ±ÅŸ yan panelinÉ™ É™lavÉ™ edir (GPT-4 ilÉ™ gÃ¼clÉ™ndirilmiÅŸ!)
// @description:be      Ð”Ð°Ð´Ð°Ðµ Ð°Ð´ÐºÐ°Ð·Ñ‹ ChatGPT Ð´Ð° Ð±Ð°ÐºÐ°Ð²Ð¾Ð¹ Ð±Ð°ÐºÐ¾Ð²Ð°Ð¹ Ð¿Ð°Ð½ÑÐ»Ñ– Google Search (Ð¿Ð°Ð´Ñ‚Ñ€Ñ‹Ð¼Ð»Ñ–Ð²Ð°ÐµÑ†Ñ†Ð° GPT-4!)
// @description:bem     Aziya ChatGPT ndalama ku Google sidebar (muma GPT-4!)  
// @description:bg      Ð”Ð¾Ð±Ð°Ð²Ñ ChatGPT Ð¾Ñ‚Ð³Ð¾Ð²Ð¾Ñ€Ð¸ ÐºÑŠÐ¼ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ‡Ð½Ð°Ñ‚Ð° Ð»ÐµÐ½Ñ‚Ð° Ð½Ð° Google Search (Ð·Ð°Ð´Ð²Ð¸Ð¶Ð²Ð°Ð½ Ð¾Ñ‚ GPT-4!)
// @description:bn      Google à¦¸à¦¾à¦‡à¦¡à¦¬à¦¾à¦°à§‡ ChatGPT à¦‰à¦¤à§à¦¤à¦° à¦¯à§‹à¦— à¦•à¦°à§‡ (à¦ªà¦¾à¦“à¦¯à¦¼à¦¾à¦°à¦¡à§‡ GPT-4 à¦¦à§à¦¬à¦¾à¦°à¦¾!)  
// @description:bo      ChatGPT à½£à½ºà¼‹à½–à½¦à¼‹à½šà½‘à¼‹à½–à½‘à½‚à¼‹à½¦à¾à¾±à½ºà½‘à¼‹à½‘à½ºà¼‹à½–à½Ÿà½´à½˜à¼‹à½¦à¾’à¾²à½²à½‚à¼‹à½“à½„à¼‹ Google à½‚à½“à½¦à¼‹à½”à¼‹à½–à½¢à¾—à½¼à½‘à¼‹à½”à¼ (GPT-4à½–à¾±à¼‹à½–à¼‹à½–à½¢à¾’à¾±à½´à½‘à¼‹à½”à¼‹!)
// @description:bs      Dodaje odgovore ChatGPT-a na boÄnu traku Google pretrage (pokreÄ‡e GPT-4!)
// @description:ca      Afegeix respostes de ChatGPT a la barra lateral de Google Search (amb tecnologia GPT-4!)  
// @description:ceb     Nagdugang sa mga tubag sa ChatGPT sa sidebar sa Google Search (gamit ang GPT-4!)
// @description:ckb     ÙˆÛ•Ø±Ú¯Ø±ØªÙ†ÛŒ Ú•Ø§Ø³ØªÛ•ÙˆØ®Û†ÛŒÛŒ ChatGPT Ø¨Û† Ù¾Û•Ù†Ø¬Û•Ø±Û•ÛŒ Ù„Ø§ØªÛŒ Ù„Û• Google (Ø¨Û• Ù¾Ø´ØªÚ¯ÛŒØ±ÛŒÛŒÛŒ GPT-4!)
// @description:cs      PÅ™idÃ¡vÃ¡ odpovÄ›di od ChatGPT do boÄnÃ­ho panelu Google Search (pohÃ¡nÄ›no GPT-4!)
// @description:cy      Ychwanega Atebion ChatGPT i'r bar ochr Google Chwilio (a gryfhawyd gan GPT-4!)  
// @description:da      TilfÃ¸jer ChatGPT-svar til Google SÃ¸g-sidelinjen (drevet af GPT-4!)
// @description:de      FÃ¼gt ChatGPT-Antworten zur Google-Seitenleiste hinzu (unterstÃ¼tzt von GPT-4!)
// @description:dv      ChatGPT Þ‡Þ¦Þ‡Þ¨Þ†Þ°ÞÞ­Þ“ÞªÞŽÞ¬ Þ–Þ¦ÞˆÞ§Þ„ÞªÞŽÞ¬ Google ÞÞ¦Þ‡Þ¨Þ“ÞªÞŽÞ¦Þ‡Þ¨ ÞŠÞ¯ÞƒÞªÞˆÞ§ÞƒÞ¦Þ‡ÞªÞŽÞ¬ Þ‘Þ¦Þ‡ÞªÞ‚Þ° (Þ‡Þ¬Þ†Þ¦Þ‡ÞªÞ‚Þ°Þ‡Þ¦Þ‡Þ¨ ÞˆÞ¦Þ†Þ¨ GPT-4!)
// @description:dz      ChatGPT à½‘à½„à¼‹ Google à½ à½–à¾±à½´à½„à¼‹à½†à½´à½„à¼‹à½£à½ºà¼‹à½–à½¦à¼‹à½ à½à½´à½¦à¼‹à½”à¼‹à½£à½‚à½¦à¼‹à½¦à¾¤à¾±à½¼à½‘à¼‹à½¦à¾’à¾²à½²à½‚à¼‹à½”à¼‹à½–à½¢à¾Ÿà½‚à½¦à¼‹à½–à½žà½´à½‚à½¦à¼ (GPT-4à¼‹à½‚à½²à¼‹à½¦à¾’à¾²à½²à½‚à¼‹à½‘à½„à¼‹!)
// @description:el      Î ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÎ¹ Î±Ï€Î±Î½Ï„Î®ÏƒÎµÎ¹Ï‚ ChatGPT ÏƒÏ„Î·Î½ Ï€Î»Î±ÏŠÎ½Î® Î³ÏÎ±Î¼Î¼Î® Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Ï„Î¿Ï… Google (Î¼Îµ Ï„Î·Î½ Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î· Ï„Î¿Ï… GPT-4!)
// @description:eo      Aldonas ChatGPT-respondojn al la flanka breto de Google SerÄ‰o (funkciigita de GPT-4!)
// @description:es      Agrega respuestas de ChatGPT a la barra lateral de Google (Â¡con tecnologÃ­a de GPT-4!)
// @description:et      Lisab ChatGPT vastused Google otsingu kÃ¼ljepaneelile (toetatud GPT-4 poolt!)
// @description:eu      Gehitu ChatGPT erantzunak Google bilaketako aldeko alderakoan (GPT-4ren aurrerapenean oinarrituta!)
// @description:fa      ChatGPT Ø¨Ù‡ Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§ÛŒ Google Ø¬Ø³ØªØ¬Ùˆ Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ GPT-4!)
// @description:fi      LisÃ¤Ã¤ ChatGPT-vastaukset Googleen (GPT-4:n tuella!)
// @description:fil     Nagdaragdag ng mga sagot ng ChatGPT sa sidebar ng Google Search (suportado ng GPT-4!)
// @description:fj      Vakarautaka na vosa vakatotolo ni ChatGPT ki na yasa ni liga ni Google (sa dodonu e GPT-4!)
// @description:fo      Leggur ChatGPT-svar til Google Leita sÃ­Ã°ustriku (viÃ° GPT-4!)
// @description:fr      Ajoute les rÃ©ponses ChatGPT Ã  la barre latÃ©rale Google (propulsÃ© par GPT-4!)
// @description:fr-CA   Ajoute les rÃ©ponses ChatGPT Ã  la barre latÃ©rale Google (propulsÃ© par GPT-4!)
// @description:ga      Cuireann freagraÃ­ ChatGPT le taobhliosta Google Cuardach (dÃ­rithe ag GPT-4!)
// @description:gd      Cuir freagairtean ChatGPT ris an taobh-siostam Google Lorg (le taca GPT-4!)  
// @description:gl      Engade as respostas de ChatGPT Ã¡ barra lateral de procura de Google (con tecnoloxÃ­a GPT-4!)
// @description:gn      OÃ±emoháº½ ChatGPT Ã±emohendu Google Ã‘epyrÅ© (MBOGUE GPT-4 rembiasakue!)
// @description:gu      Google àª¸àª¾àª‡àª¡àª¬àª¾àª°àª®àª¾àª‚ ChatGPT àªœàªµàª¾àª¬à«‹ àª‰àª®à«‡àª°à«‡ àª›à«‡ (GPT-4 àª¦à«àªµàª¾àª°àª¾ àª¸àª®àª°à«àª¥àª¿àª¤!)  
// @description:ha      Zaya sauyaÆ™a daga ChatGPT zuwa bidiyo na bidiyon Google (mai bincike ta GPT-4!)
// @description:haw     HoÊ»ohui aku i nÄ hÅÊ»ike a ChatGPT i ka papa aoÊ»ao hema o ka Ê»imi Ê»ana iÄ Google (e hÅÊ»oikaika ana e GPT-4!)
// @description:he      ×”×•×¡×¤×ª ×ª×©×•×‘×•×ª ChatGPT ×œ×¡×¨×’×œ ×”×¦×“ ×©×œ Google ×—×™×¤×•×© (×ž×•×¤×¢×œ ×¢×œ ×™×“×™ GPT-4!)
// @description:hi      Google à¤¸à¤¾à¤‡à¤¡à¤¬à¤¾à¤° à¤®à¥‡à¤‚ ChatGPT à¤‰à¤¤à¥à¤¤à¤° à¤œà¥‹à¤¡à¤¼à¤¤à¤¾ à¤¹à¥ˆ (GPT-4 à¤¦à¥à¤µà¤¾à¤°à¤¾ à¤¸à¤®à¤°à¥à¤¥à¤¿à¤¤!)
// @description:hr      Dodaje odgovore aplikacije ChatGPT boÄnoj traci pretraÅ¾ivanja Google (pokreÄ‡e GPT-4!)
// @description:ht      Ajoute repons ChatGPT nan barre laterale RechÃ¨ch Google a (dise GPT-4!)  
// @description:hu      A ChatGPT vÃ¡laszokat ad a Google KeresÃ©s oldalsÃ¡vjÃ¡hoz (GPT-4 Ã¡ltal hajtva!)
// @description:hy      Ô±Õ¾Õ¥Õ¬Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ§ ChatGPT ÕºÕ¡Õ¿Õ¡Õ½Õ­Õ¡Õ¶Õ¶Õ¥Ö€Õ¨ Google Õ¸Ö€Õ¸Õ¶Õ¸Ö‚Õ´Õ« Õ¯Õ¸Õ²Õ´Õ«Ö (Õ¡Õ»Õ¡Õ¯ÖÕ¸Ö‚Õ´Õ¸Õ¾ GPT-4!)
// @description:id      Menambahkan jawaban ChatGPT ke sidebar Google Search (digerakkan oleh GPT-4!)
// @description:ig      Tinye obere ChatGPT na-aga n'etiti ozi aká»¥ká»¥ Google Search (na-ezute GPT-4!)
// @description:is      BÃ¦tir viÃ° ChatGPT svarum viÃ° hliÃ°ina Ã¡ Google leitarstiku (mjÃ¶g GPT-4!)  
// @description:it      Aggiunge le risposte ChatGPT alla barra laterale di Google (basata su GPT-4!)
// @description:iu      áŠá‘Žá’ªáƒá“á“‚áŠá•á“‚á–… ChatGPT á…á–ƒá…á“¯á’»á“‚á’ƒ Google á‘Žá‘Žá•‹á–… (GPT-4 á‘•á’ªá’ƒá“´áƒá“‚á–…!)
// @description:ja      ChatGPT ã®å›žç­”ã‚’ Google ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¿½åŠ ã—ã¾ã™ (GPT-4 ã‚’æ­è¼‰!)
// @description:jv      Nambaki jawaban ChatGPT menyang sidebar Google Search (didandani dening GPT-4!)
// @description:ka      áƒ“áƒáƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ¡ ChatGPT áƒžáƒáƒ¡áƒ£áƒ®áƒ”áƒ‘áƒ¡ Google áƒ«áƒ˜áƒ”áƒ‘áƒ˜áƒ¡ áƒ’áƒ•áƒ”áƒ áƒ“áƒ˜áƒ¡ áƒ’áƒ•áƒ”áƒ áƒ“áƒ–áƒ” (GPT-4-áƒ˜áƒ¡ áƒ›áƒ®áƒáƒ áƒ“áƒáƒ­áƒ”áƒ áƒ˜áƒ—!)
// @description:kg      Kweyisa mawu a ChatGPT kuna sebukulu Google Search (ekupesana na GPT-4!)
// @description:kk      ChatGPT Ð¶Ð°ÑƒÐ°Ð¿Ñ‚Ð°Ñ€Ñ‹Ð½ Google Ñ–Ð·Ð´ÐµÑƒ Ð¶Ð¾Ð»Ð°Ò“Ñ‹Ð½Ð° Ò›Ð¾ÑÐ°Ð´Ñ‹ (GPT-4 Ð¶ÐµÑ‚Ñ–ÑÐ¿ÐµÐ½Ð´Ñ–!)
// @description:km      áž”áž“áŸ’ážáŸ‚áž˜áž€áž¶ážšáž†áŸ’áž›áž¾áž™áž“áŸƒ ChatGPT áž‘áŸ…áž‡áž¶áž“áŸ‹áž”áŸ’ážšáŸ‚áž€áŸ’ážšážœáž¼áž€ážŸáŸ’ážœáŸ‚áž€ážšáž€ Google (ážšáž€áž‡áŸ†áž“áž»áŸ†ážŠáŸ„áž™ GPT-4)áŸ”
// @description:kn      Google à²¹à³†à²¸à²°à²¿à²¨à²²à³à²²à²¿ ChatGPT à²‰à²¤à³à²¤à²°à²—à²³à²¨à³à²¨à³ à²¸à³‡à²°à²¿à²¸à²²à²¾à²—à³à²¤à³à²¤à²¦à³† (à²œà²¿à²ªà²¿à²Ÿà²¿-4 à²†à²—à²¿à²¦à³†!)  
// @description:ko      Google ì‚¬ì´ë“œë°”ì— ChatGPT ë‹µë³€ ì¶”ê°€ (GPT-4 ê¸°ë°˜!)
// @description:kok     Google à¤¶à¥‹à¤§à¤¨ à¤¬à¤¾à¤°à¤•à¤¿à¤Ÿà¥‡à¤²à¥‹ à¤µà¤° ChatGPT à¤‰à¤¤à¥à¤¤à¤° à¤œà¤¾à¤¤à¥‹ (GPT-4 à¤¦à¥à¤µà¤¾à¤°à¥‡ à¤¸à¤®à¤°à¥à¤¥à¤¿à¤¤!)
// @description:ku      Li ser karkera lÃªgerÃ®na Google ChatGPT parve dike (bi karÃª GPT-4 anÃ®n!)
// @description:ky      ChatGPT Ð¶Ð°ÑƒÐ°Ð¿Ñ‚Ð°Ñ€Ñ‹Ð½ Google Ð¸Ð·Ð´Ó©Ó© Ð¶Ð¾Ð»ÑƒÐ½Ð´Ð¾ ÐºÐ¾ÑˆÐ¾Ñ‚Ð¾Ñ‚ (GPT-4 Ð¶Ð°Ñ€Ð´Ð°Ð¼Ñ‹ Ð¼ÐµÐ½ÐµÐ½!)
// @description:la      Adiungit responsiones ChatGPT ad lateralem mensam quaerendi Google (GPT-4 motore!)
// @description:lb      Setzt ChatGPT Ã„ntwerten op Google Sichfenster bÃ¤i (gedriwwt vum GPT-4!)  
// @description:lo      à»€àºžàºµà»ˆàº¡àº„à»àº²àº•àº­àºš ChatGPT à»„àº›àºªàº°à»àº”àº‡à»„àº§à»‰à»ƒàº™à»àºšàºšàº‚àº­àº‡ Google VÃ¼kos (à»‚àº”àº GPT-4!)
// @description:lt      Prideda ChatGPT atsakymus Ä¯ â€žGoogleâ€œ paieÅ¡kos Å¡oninÄ¯ juostos rÄ—melÄ¯ (naudojant â€žGPT-4â€œ!)
// @description:lv      Pievieno ChatGPT atbildes Google meklÄ“Å¡anas sÄnjoslÄ (darbinÄts ar GPT-4!)  
// @description:mg      Mampiditra valiny avy amin'ny ChatGPT ao amin'ny laharana tenim-paharetan'ny Google (amin'ny alalan'ny GPT-4!)
// @description:mi      Whakapau kÅrero mai te ChatGPT ki te whÄ«tiki o Google Search (e whakahauhau ana e GPT-4!)
// @description:mk      Ð”Ð¾Ð´Ð°Ð²Ð°ÑšÐµ Ð½Ð° ChatGPT Ð¾Ð´Ð³Ð¾Ð²Ð¾Ñ€Ð¸ Ð²Ð¾ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ‡Ð½Ð°Ñ‚Ð° Ð»ÐµÐ½Ñ‚Ð° Ð½Ð° Google Ð¿Ñ€ÐµÐ±Ð°Ñ€ÑƒÐ²Ð°ÑšÐµ (Ð¿Ð¾Ð´Ð´Ñ€Ð¶ÑƒÐ²Ð°Ð½Ð¾ Ð¾Ð´ GPT-4!)
// @description:ml      Google à´¸àµ‹à´³à´¿àµ½ ChatGPT à´‰à´¤àµà´¤à´°à´™àµà´™àµ¾ à´šàµ‡àµ¼à´•àµà´•àµà´¨àµà´¨àµ (GPT-4 à´ªàµà´°à´šà´¾à´°à´¿à´•àµà´•àµà´¨àµà´¨àµ!)  
// @description:mn      ChatGPT Ñ…Ð°Ñ€Ð¸ÑƒÐ»Ñ‚ÑƒÑƒÐ´Ñ‹Ð³ Google Ñ…Ð°Ð¹Ð»Ñ‚Ñ‹Ð½ Ñ…Ð°Ð¶ÑƒÑƒ Ñ‚Ð°Ð»Ð´ Ð½ÑÐ¼Ð½Ñ (GPT-4 Ð´ÑÐ¼Ð¶Ð¸Ð»Ñ‚Ñ‚ÑÐ¹!)
// @description:mr      à¤—à¥‚à¤—à¤²à¤µà¤° ChatGPT à¤ªà¥à¤°à¤¤à¤¿à¤¸à¤¾à¤¦ à¤œà¥‹à¤¡à¤²à¤¾ à¤œà¤¾à¤¤à¥‹ (à¤œà¥€à¤ªà¥€à¤Ÿà¥€-4 à¤¦à¥à¤µà¤¾à¤°à¥‡ à¤¸à¤®à¤°à¥à¤¥à¤¿à¤¤!)
// @description:ms      Menambah jawapan ChatGPT ke sidebar Carian Google (dikuasakan oleh GPT-4!)
// @description:mt      IÅ¼Å¼id ir-risposti tal-ChatGPT lill-sidebar tat-Tikketta Google (ppowrat bl-GPT-4!)
// @description:my      Google á€›á€¾á€­ ChatGPT á€¡á€–á€¼á€±á€€á€­á€¯á€‘á€Šá€·á€ºá€žá€½á€„á€ºá€¸á€›á€”á€º (GPT-4 á€–á€¼á€„á€·á€ºá€¡á€‘á€±á€¬á€€á€ºá€¡á€•á€¶á€·á€¡á€†á€¯á€¶á€¸!)
// @description:na      Ongerenga mei a ChatGPT i le tofiga o Google SuÊ»esuÊ»ega (faÊ»atasi e GPT-4!)
// @description:nb      Legger til ChatGPT-svar i Google SÃ¸k sidefelt (drevet av GPT-4!)
// @description:nd      Ithunyelwe izithuthi za ChatGPT kuqukethwe kwesibhakabhaka seGoogle Search (edlalwa ngu GPT-4!)
// @description:ne      Google à¤–à¥‹à¤œà¤•à¥‹ à¤¸à¤¾à¤‡à¤¡à¤¬à¤¾à¤°à¤®à¤¾ ChatGPT à¤‰à¤¤à¥à¤¤à¤°à¤¹à¤°à¥‚ à¤¥à¤ªà¥à¤¦à¥ˆ (GPT-4 à¤¦à¥à¤µà¤¾à¤°à¤¾ à¤¸à¤®à¤°à¥à¤¥à¤¿à¤¤!)
// @description:ng      Ongeza mafandikio ya ChatGPT ku tepu ya Google Search (mbitsiwa na GPT-4!)
// @description:nl      Voegt ChatGPT-antwoorden toe aan de zijkant van Google Zoeken (aangedreven door GPT-4!)
// @description:nn      Legg til ChatGPT-svar i Google SÃ¸k sidefelt (drivne av GPT-4!) 
// @description:no      Legger til ChatGPT-svar i Google SÃ¸k sidefelt (drevet av GPT-4!)
// @description:nso     E ngata re tswetÅ¡e diphetho tÅ¡a ChatGPT go setÅ¡habeng sa Google Search (ka ditshehetsweng ke GPT-4!)
// @description:ny      Ndadzivula mawu a ChatGPT ku sesele ya Google Search (yosungiridwa ndi GPT-4!)
// @description:oc      Apond las responsas de ChatGPT a la barra laterala de Google Search (alimentat per GPT-4 !)
// @description:om      Fayyadamnu Google Ayyaanni ChatGPT tiwwiiqaa garaa garaatti argachuu dandeenyu (gadi dhiiraa GPT-4!)
// @description:or      à¬—à­à¬—à¬² à¬–à­‹à¬œà¬° à¬¸à¬¾à¬‡à¬¡à¬¬à¬¾à¬°à¬°à­‡ ChatGPT à¬‰à¬¤à­à¬¤à¬° à¬¯à­‹à¬¡à¬¼à¬¾à¬¯à¬¾à¬‡à¬›à¬¿ (GPT-4 à¬¦à­à¬¬à¬¾à¬°à¬¾ à¬ªà­à¬°à¬¾à¬§à¬¾à¬¨!)
// @description:pa      à¨—à©‚à¨—à¨² à¨–à©‹à¨œ à¨¦à©‡ à¨¸à¨¾à¨ˆà¨¡à¨¬à¨¾à¨° 'à¨š ChatGPT à¨‰à©±à¨¤à¨° à¨¸à¨¼à¨¾à¨®à¨² à¨•à©€à¨¤à©‡ à¨—à¨ à¨¨à©‡ (GPT-4 à¨¦à©€ à¨®à©‚à¨² à¨¤à©‹à¨‚ à¨šà¨²à¨¾à¨‡à¨† à¨—à¨¿à¨†!)
// @description:pl      Dodaje odpowiedzi ChatGPT w pasku bocznym Google (obsÅ‚ugiwane przez GPT-4!)
// @description:ps      Ø¯ Ú«ÙˆÚ«Ù„ Ù„Ù¼ÙˆÙ† Ú©Û ChatGPT Ø¬ÙˆØ§Ø¨ÙˆÙ†Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©ÙˆÙŠ (Ø¯ GPT-4 Ø³Ø±Ù‡ Ù¾Ù‡ Ø§Ù†Ø¬Ù† Ú©Û Ú©Ø§Ø± Ù¾Ù„ÙˆØ±Ù„ Ø´ÙˆÛŒ!)
// @description:pt      Adiciona respostas do ChatGPT Ã  barra lateral do Google Search (com suporte da GPT-4!)
// @description:pt-BR   Adiciona respostas do ChatGPT Ã  barra lateral do Google Search (com suporte da GPT-4!)  
// @description:qu      ChatGPT munankunapuraqmi Google Ã±awpa pachapi yanapaq (GPT-4 yachachiqkuna)
// @description:rm      Agiunta las respostas da ChatGPT a la barra laterala da Google Search (sustegnÃ¬ da GPT-4!)
// @description:rn      Abaririza amajwi nka ChatGPT ku rubuga rw'ikibazo cya Google (yashinzwe na GPT-4!)
// @description:ro      AdaugÄƒ rÄƒspunsurile ChatGPT Ã®n bara lateralÄƒ Google CÄƒutare (susÈ›inut de GPT-4!)
// @description:ru      Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ñ‹ ChatGPT Ð½Ð° Ð±Ð¾ÐºÐ¾Ð²ÑƒÑŽ Ð¿Ð°Ð½ÐµÐ»ÑŒ Google (Ð½Ð° Ð±Ð°Ð·Ðµ GPT-4!)
// @description:rw      Byongeyeza amajwi yo mubu sideba ya Google ChatGPT (yashinzwe na GPT-4!)  
// @description:sa      à¤—à¥‚à¤—à¤² à¤¯à¤¾à¤¨à¥à¤¤à¥à¤°à¤¿à¤•à¥‡ à¤…à¤­à¤¿à¤¨à¥à¤¨à¤§à¥€à¤¯à¥‹ à¤®à¤¾à¤°à¥à¤—à¥‡à¤£ à¤šà¤¾à¤Ÿà¤—à¤¿à¤ªà¤Ÿà¤¿à¤‚ à¤‰à¤¤à¥à¤¤à¤°à¤®à¥ (à¤—à¥€à¤ªà¥€à¤Ÿà¥€-à¥ª à¤ªà¥à¤°à¥‡à¤°à¤¿à¤¤à¤ƒ)! 
// @description:sat     Googleá±¥ á±µá±Ÿá±¨á±¦á±Ÿá±¨á±šá±› á± á±Ÿá±¹á±žá±¤á±žá±Ÿ ChatGPT á±¨á±®á±žá±Ÿ á±¦á±šá±±á±®á±¡ (GPT-4 á±šá±›á±·á±Ÿ á± á±šá±¢á±µá±šá±¨á±Ÿá±ºá±¡!)
// @description:sc      Aghedda is responsas de ChatGPT a sa barra de cerca de Google (adantzadu dae GPT-4!)
// @description:sd      Ú¯ÙˆÚ¯Ù„ Ø³Ø±Ú† Û¾ ChatGPT Ø¬Ùˆ Ø¬ÙˆØ§Ø¨ÙˆÙ† Ø§Ø¶Ø§ÙÙˆ ÚªÙŠÙ„ Ø¢Ù‡ÙŠ (GPT-4 Ú©ÙŠ Ø·Ø§Ù‚Øª ÙˆØ±Ø¬Ú» ÙˆØ§Ø±Ùˆ!)
// @description:se      Loahpa ChatGPT-vÃ¡stÃ¡dusat Google Gaskkaside (doaimmasaÅ¡ GPT-4!)
// @description:sg      Tisa na tÃ®sÃ¢nga lusÃ¢ngo lu ChatGPT kuna ntsÃ¢di ya Google (sa tebelÃ® GPT-4!)
// @description:si      Google à·ƒà·™à·€à·”à¶¸à·š ChatGPT à¶´à·’à·…à·’à¶­à·”à¶»à·” à¶‘à¶šà¶­à·” à¶šà¶»à¶ºà·’ (GPT-4 à·€à·™à¶­ à·ƒà·„à·à¶º à¶šà·…à·!)  
// @description:sk      PridÃ¡va odpovede ChatGPT do boÄnej liÅ¡ty vyhÄ¾adÃ¡vania Google (pomocou GPT-4!)
// @description:sl      Dodaja odgovore ChatGPT v stransko vrstico iskanja Google (podprto s strani GPT-4!) 
// @description:sm      FaÊ»aalia atonu a le ChatGPT i le taavale lautele o le Google SuÊ»esuÊ»ega (faÊ»atasi i le GPT-4!)
// @description:sn      Kupurikira maitiro eChatGPT kuve kuwandisa wevhu raGoogle Search (akakosha neGPT-4!)
// @description:so      Ku darin xogta ChatGPT ee gooshi Google Search (lagu taageerayo GPT-4!)
// @description:sq      Shton pÃ«rgjigje ChatGPT nÃ« anÃ«bardhÃ«n e kÃ«rkimit Google (e mbÃ«shtetur nga GPT-4!)  
// @description:sr      Ð”Ð¾Ð´Ð°Ñ˜Ðµ Ð¾Ð´Ð³Ð¾Ð²Ð¾Ñ€Ðµ Ð§Ð°Ñ‚Ð“ÐŸÐ¢-Ð° Ñƒ Ñ‚Ñ€Ð°ÐºÑƒ Ð·Ð° Ð¿Ñ€ÐµÑ‚Ñ€Ð°Ð³Ñƒ Google (Ð¿Ð¾Ð´Ñ€Ð¶Ð°Ð½Ð¾ Ð¾Ð´ ÑÑ‚Ñ€Ð°Ð½Ðµ Ð“ÐŸÐ¢-4!)
// @description:ss      Faka amavulandlela aseChatGPT e sidebarenge sikaGoogle Seaching (okusekelwa ngu GPT-4!)
// @description:st      Kgetha ChatGPT ho litlhopho tsa Google Thetsa (ho hlolehileng ka GPT-4!)
// @description:su      Nambihan jawaban ChatGPT ka sisi kiri Google (diyandakÃ© pikeun GPT-4!)
// @description:sv      LÃ¤gger till ChatGPT-svar i Google-sÃ¶kraden (drivs av GPT-4!) 
// @description:sw      Inaongeza majibu ya ChatGPT kwenye ubao wa upande wa Google (inaendeshwa na GPT-4!)
// @description:ta      à®•à¯‚à®•à®¿à®³à¯ à®¤à¯‡à®Ÿà®²à®¿à®©à¯ à®ªà®•à¯à®•à®¤à¯à®¤à®¿à®²à¯ ChatGPT à®ªà®¤à®¿à®²à¯à®•à®³à¯ˆà®šà¯ à®šà¯‡à®°à¯à®•à¯à®•à®¿à®©à¯à®±à®¤à¯ (GPT-4 à®†à®©à¯à®²à®¾à®©à¯!)
// @description:te      à°—à±‚à°—à±à°²à± à°¶à±‹à°§à°¨ à°ªà°Ÿà±à°Ÿà°¿à°• à°ªà±ˆ ChatGPT à°¸à°®à°¾à°§à°¾à°¨à°¾à°²à°¨à± à°œà±‹à°¡à°¿à°¸à±à°¤à±à°‚à°¦à°¿ (GPT-4 à°¦à±à°µà°¾à°°à°¾ à°®à±Šà°¤à±à°¤à°‚à°—à°¾!)
// @description:tg      Ð—Ð¸Ñ‘Ð´ ÐºÐ°Ñ€Ð´Ð°Ð½Ð¸ Ò·Ð°Ð²Ð¾Ð±Ò³Ð¾Ð¸ ChatGPT Ð±Ð° Ñ‚Ð°Ñ€Ð°Ñ„Ð¸ ÑÐ°Ñ‚Ò³Ð¸ Ò·ÑƒÑÑ‚ÑƒÒ·Ó¯ Google (Ð°ÑÐ¾ÑÑˆÐ°Ð²Ó£ Ð±Ð° GPT-4!)
// @description:th      à¹€à¸žà¸´à¹ˆà¸¡à¸„à¹à¸²à¸•à¸­à¸šà¸ˆà¸²à¸ ChatGPT à¹ƒà¸™à¹à¸–à¸šà¸”à¹‰à¸²à¸™à¸‚à¹‰à¸²à¸‡à¸‚à¸­à¸‡à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸² Google (à¸£à¸­à¸‡à¸£à¸±à¸šà¹‚à¸”à¸¢ GPT-4!)
// @description:ti      áŠ£á‰¥ Google áˆµáˆáŒ áŠ“ áŠ£á‰¥ ChatGPT áˆáˆáŠ­á‰µáŠ• áŠ£áˆ›áˆ«áŒº (á‰ á‰°áˆ˜áˆµáˆ¨á‰  á‰ á‰°áŠ• GPT-4!)
// @description:tk      Google gecikmÃ¤ge ChatGPT jogaby goÅŸÃ½ar (GPT-4 bilen!)
// @description:tl      Nagdadagdag ng mga sagot ng ChatGPT sa sidebar ng Google Search (suportado ng GPT-4!)  
// @description:tn      Viseza izisho zika ChatGPT kwekhoni leGoogle Search (kukhombisa ngokweGPT-4!)
// @description:to      TÄnaki e ngaue kihe sipa tali fakapotopoto 'o e Google ngaue 'o e ChatGPT (tokotaha 'e GPT-4!)
// @description:tr      ChatGPT yanÄ±tlarÄ±nÄ± Google Arama kenar Ã§ubuÄŸuna ekler (GPT-4 tarafÄ±ndan desteklenir!)
// @description:ts      Vuyisa mati na ChatGPT hi xiphemu leGoogle Search (hosiwa hi GPT-4!)
// @description:tt      Google Ð­Ð·Ð»Ó™Ò¯ Ò¯Ñ‚ÐµÐºÐ»Ðµ ChatGPT ÐºÐ°Ñ‚Ð½Ð°ÑˆÑ‚Ñ‹Ñ€Ñƒ (GPT-4 Ð¸Ñ‚ÐµÐ³ÐµÐ·ÐµÐºÐºÓ™Ð½!)
// @description:tw      HwÉ› ChatGPT adefoÉ” dodoÉ” Google hwee (ka ho asasaa GPT-4!)
// @description:ug      Google Ø¦Ù‰Ø²Ø¯Û•Ø´ØªÛ• ChatGPT Ø¬Ø§Û‹Ø§Ø¨Ù„Ù‰Ø±Ù‰Ù†Ù‰ Ù‚ÙˆØ´Û‡Ø´ (GPT-4 Ø¯Ù‰Ù† Ù‚ÙˆÙ„Ù„Ø§ÙŠØ¯Û‡!)
// @description:uk      Ð”Ð¾Ð´Ð°Ñ” Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ– ChatGPT Ñƒ Ð±Ñ–Ñ‡Ð½Ð¸Ð¹ Ð¿Ð°Ð½ÐµÐ»Ñ– Ð¿Ð¾ÑˆÑƒÐºÑƒ Google (Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ”Ñ‚ÑŒÑÑ GPT-4!)
// @description:ur      Ú¯ÙˆÚ¯Ù„ ØªÙ„Ø§Ø´ Ú©ÛŒ Ø·Ø±Ù ChatGPT Ú©Û’ Ø¬ÙˆØ§Ø¨Ø§Øª Ø´Ø§Ù…Ù„ Ú©Ø±ØªØ§ ÛÛ’ (Ø¬ÛŒÙ¾ÛŒ Ù¹ÛŒ-4 Ú©ÛŒ Ù…Ø¯Ø¯ Ø³Û’!)
// @description:uz      Google qidiruviga ChatGPT javoblari qo'shadi (GPT-4 tomonidan qo'llab-quvvatlanadi!)
// @description:ve      Vhohodzi vha ChatGPT kha vhavhili ya Google Fambisa (vha sungulwa na GPT-4!)
// @description:vi      ThÃªm cÃ¢u tráº£ lá»i cá»§a ChatGPT vÃ o thanh bÃªn Google Search (Ä‘Æ°á»£c há»— trá»£ bá»Ÿi GPT-4!)
// @description:vo      LÃ¤Ã¼kon datans ChatGPT ad pÃ¤t binon Google VÃ¼kos (nÃ¼konoson dÃ¶ GPT-4!)
// @description:wa      Ã…dd doveses di Dj ChatGPT a l' cohteye di Dj Google (rÃ¨hnutÃ® pa GPT-4 !)
// @description:wo      Ndax duggÃ«wul ChatGPT du bind ak wertali Google (naataanal ku GPT-4!)
// @description:xh      Nika izicelo zika ChatGPT ezinkunzi ngesandla samazwi eGoogle Search (zakhiwo ngu GPT-4!)
// @description:yi      ×¦×•×’×¢×¤×™×’×˜ ×Ö·× ×˜×•×•×Ö¸×¨×˜×Ÿ ×¤×•×Ÿ ×˜×©×Ö·×˜×’×¤Ö¼×˜ ××™×Ÿ ×’×•×’×œ ×–×•×›×Ÿ ×–×™×™Ö·×˜×‘×Ö·×¨ (×’×¢×©×˜×™×¦×˜ ×“×•×¨×›×Ÿ ×’×¤Ö¼×˜-4!)
// @description:yo      Fi awá»n iwe itumá» ChatGPT si abala iwoye Google (á¹£iá¹£e ni GPT-4!)
// @description:za      Ngozv yi ChatGPT nv nqgozv ya Google Search (dqvliuzgozv ngel GPT-4!)
// @description:zh      å°† ChatGPT ç­”æ¡ˆæ·»åŠ åˆ° Google ä¾§è¾¹æ  (ç”± GPT-4 æä¾›æ”¯æŒ!)
// @description:zh-CN   å°† ChatGPT ç­”æ¡ˆæ·»åŠ åˆ° Google ä¾§è¾¹æ  (ç”± GPT-4 æä¾›æ”¯æŒ!)
// @description:zh-HK   å°‡ ChatGPT ç­”æ¡ˆæ·»åŠ åˆ° Google å´é‚Šæ¬„ (ç”± GPT-4 æä¾›æ”¯æŒ!)
// @description:zh-SG   å°† ChatGPT ç­”æ¡ˆæ·»åŠ åˆ° Google ä¾§è¾¹æ  (ç”± GPT-4 æä¾›æ”¯æŒ!)
// @description:zh-TW   å°‡ ChatGPT ç­”æ¡ˆæ·»åŠ åˆ° Google å´é‚Šæ¬„ (ç”± GPT-4 æä¾›æ”¯æŒ!)
// @description:zu      Faka amaphawu ase-ChatGPT kuvaliwe i-Google Search (okwesikhashana ngu-GPT-4!)
// @author              KudoAI
// @namespace           https://kudoai.com
// @version             2023.10.1
// @license             MIT
// @icon                https://www.google.com/s2/favicons?sz=64&domain=google.com
// @match               *://*.google.com/search?*
// @include             https://auth0.openai.com
// @connect             raw.githubusercontent.com
// @connect             greasyfork.org
// @connect             chat.openai.com
// @connect             api.aigcfun.com
// @require             https://cdn.jsdelivr.net/gh/kudoai/chatgpt.js@b3192595ebef3c59235eaa238a4a62cf4dd7b6bf/dist/chatgpt-2.3.2.min.js
// @require             https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js
// @require             https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js
// @grant               GM_getValue
// @grant               GM_setValue
// @grant               GM_deleteValue
// @grant               GM_cookie
// @grant               GM_registerMenuCommand
// @grant               GM_unregisterMenuCommand
// @grant               GM_openInTab
// @grant               GM.xmlHttpRequest
// @homepageURL         https://googlegpt.kudoai.com
// @supportURL          https://googlegpt.kudoai.com/issues
// ==/UserScript==

// NOTE: This script relies on the powerful chatgpt.js library @ https://chatgpt.js.org (c) 2023 KudoAI & contributors under the MIT license
// ...and KaTeX, the fastest math typesetting library @ https://katex.org (c) 2013â€“2020 Khan Academy & contributors under the MIT license

(async () => {

    // Define SCRIPT functions

    function loadSetting(...keys) { keys.forEach(key => { config[key] = GM_getValue(config.prefix + '_' + key, false) })}
    function saveSetting(key, value) { GM_setValue(config.prefix + '_' + key, value) ; config[key] = value }
    function safeWindowOpen(url) { window.open(url, '_blank', 'noopener') } // to prevent backdoor vulnerabilities

    function updateCheck() {

        // Fetch latest meta
        const currentVer = GM_info.script.version
        GM.xmlHttpRequest({
            method: 'GET', url: config.updateURL + '?t=' + Date.now(),
            headers: { 'Cache-Control': 'no-cache' },
            onload: (response) => {

                // Compare versions
                const latestVer = /@version +(.*)/.exec(response.responseText)[1]
                for (let i = 0 ; i < 4 ; i++) { // loop thru subver's
                    const currentSubVer = parseInt(currentVer.split('.')[i], 10) || 0,
                          latestSubVer = parseInt(latestVer.split('.')[i], 10) || 0
                    if (currentSubVer > latestSubVer) break // out of comparison since not outdated
                    else if (latestSubVer > currentSubVer) { // if outdated

                        // Alert to update
                        const updateAlertID = alert(messages.alert_updateAvail + '! ðŸš€', // title
                            messages.alert_newerVer + ' GoogleGPT v' + latestVer + ' '
                                + messages.alert_isAvail + '!   '
                                + '<a target="_blank" rel="noopener" style="font-size: 0.7rem" '
                                    + 'href="' + config.gitHubURL + '/commits/main/greasemonkey/'
                                    + config.updateURL.replace(/.*\/(.*)meta\.js/, '$1user.js') + '" '
                                    + '>' + messages.link_viewChanges + '</a>',
                            function update() { // button
                                GM_openInTab(config.updateURL.replace('meta.js', 'user.js') + '?t=' + Date.now(),
                                    { active: true, insert: true } // focus, make adjacent
                                ).onclose = () => location.reload() },
                            '', 328 // width
                        )

                        // Localize button labels if needed
                        if (!config.userLanguage.startsWith('en')) {
                            const updateAlert = document.querySelector(`[id="${ updateAlertID }"]`)
                            updateAlert.querySelectorAll('button')[1].textContent = messages.buttonLabel_update
                            updateAlert.querySelectorAll('button')[0].textContent = messages.buttonLabel_dismiss
                        }

                        return
                }}

                alert(`${ messages.alert_upToDate }!`, // title
                        `GoogleGPT (v${ currentVer }) ${ messages.alert_isUpToDate }!`) // msg
    }})}

    // Define MENU functions

    function getUserscriptManager() { try { return GM_info.scriptHandler } catch (err) { return 'other' }}

    function registerMenu() {
        const menuIDs = [] // to store registered commands for removal while preserving order
        const state = {
            symbol: ['âœ”ï¸', 'âŒ'], word: ['ON', 'OFF'],
            separator: getUserscriptManager() === 'Tampermonkey' ? ' â€” ' : ': ' }

        // Add command to toggle proxy API mode
        const pamLabel = state.symbol[+!config.proxyAPIenabled]
                       + ' ' + messages.menuLabel_proxyAPImode + ' '
                       + state.separator + state.word[+!config.proxyAPIenabled]
        menuIDs.push(GM_registerMenuCommand(pamLabel, function() {
            saveSetting('proxyAPIenabled', !config.proxyAPIenabled)
            notify(messages.menuLabel_proxyAPImode + ' '
                + messages['state_' + ( config.proxyAPIenabled ? 'enabled' : 'disabled' )])
            for (const id of menuIDs) { GM_unregisterMenuCommand(id) } registerMenu() // refresh menu
            location.reload() // re-send query using new endpoint
        }))

        // Add command to toggle prefix mode
        const pmLabel = state.symbol[+!config.prefixEnabled] + ' '
                      + messages.menuLabel_require + ' "/" '
                      + messages.menuLabel_beforeQuery + ' '
                      + state.separator + state.word[+!config.prefixEnabled]
        menuIDs.push(GM_registerMenuCommand(pmLabel, function() {
            saveSetting('prefixEnabled', !config.prefixEnabled)
            if (config.prefixEnabled && config.suffixEnabled) { // disable Suffix Mode if activating Prefix Mode
                saveSetting('suffixEnabled', !config.suffixEnabled) }
            notify(messages.alert_prefixMode + ' '
                + messages['state_' + ( config.prefixEnabled ? 'enabled' : 'disabled' )])
            for (const id of menuIDs) { GM_unregisterMenuCommand(id) } registerMenu() // refresh menu
            if (!config.prefixEnabled) location.reload() // re-send query if newly disabled
        }))

        // Add command to toggle suffix mode
        const smLabel = state.symbol[+!config.suffixEnabled] + ' '
                      + messages.menuLabel_require + ' "?" '
                      + messages.menuLabel_afterQuery + ' '
                      + state.separator + state.word[+!config.suffixEnabled]
        menuIDs.push(GM_registerMenuCommand(smLabel, function() {
            saveSetting('suffixEnabled', !config.suffixEnabled)
            if (config.prefixEnabled && config.suffixEnabled) { // disable Prefix Mode if activating Suffix Mode
                saveSetting('prefixEnabled', !config.prefixEnabled) }
            notify(messages.alert_suffixMode + ' '
                + messages['state_' + ( config.suffixEnabled ? 'enabled' : 'disabled' )])
            for (const id of menuIDs) { GM_unregisterMenuCommand(id) } registerMenu() // refresh menu
            if (!config.suffixEnabled) location.reload() // re-send query if newly disabled
        }))

        // Add command to set reply language
        const rlLabel = 'ðŸŒ ' + messages.menuLabel_replyLanguage
                      + state.separator + config.replyLanguage
        menuIDs.push(GM_registerMenuCommand(rlLabel, () => {
            while (true) {
                const replyLanguage = prompt(
                    messages.prompt_updateReplyLang + ':', config.replyLanguage)
                if (replyLanguage === null) break // user cancelled so do nothing
                else if (!/\d/.test(replyLanguage)) {
                    saveSetting('replyLanguage', replyLanguage || config.userLanguage)
                    alert(messages.alert_langUpdated + '!', // title
                        'GoogleGPT ' + messages.alert_willReplyIn + ' '
                            + ( replyLanguage || messages.alert_yourSysLang ) + '.')
                    for (const id of menuIDs) { GM_unregisterMenuCommand(id) } registerMenu() // refresh menu
                    break
        }}}))

        // Add command to launch About modal
        const aboutLabel = 'ðŸ’¡ ' + messages.menuLabel_about + ' GoogleGPT'
        menuIDs.push(GM_registerMenuCommand(aboutLabel, async () => {

            // Show alert
            const chatgptJSver = /chatgpt-([\d.]+)\.min/.exec(GM_info.script.header)[1] || ''
            const aboutAlertID = alert(
                'GoogleGPT', // title
                ' ' + messages.alert_version + ': ' + GM_info.script.version + '\n '
                    + messages.alert_poweredBy + ': '
                    + '<a href="https://chatgpt.js.org" target="_blank" rel="noopener">chatgpt.js</a>'
                    + ( chatgptJSver ? ( ' v' + chatgptJSver ) : '' ),
                [ // buttons
                    function checkForUpdates() { updateCheck() },
                    function githubSource() { safeWindowOpen(config.gitHubURL) },
                    function leaveAReview() { safeWindowOpen(
                        config.greasyForkURL + '/feedback#post-discussion') }
                ], '', 524) // About modal width

            // Re-format buttons to include emojis + re-case + hide 'Dismiss'
            for (const button of document.getElementById(aboutAlertID).querySelectorAll('button')) {
                if (/updates/i.test(button.textContent))
                    button.textContent = 'ðŸš€ ' + messages.buttonLabel_updateCheck
                else if (/review/i.test(button.textContent))
                    button.textContent = 'â­ ' + messages.buttonLabel_leaveReview
                else if (/github/i.test(button.textContent))
                    button.textContent = 'ðŸ“œ ' + messages.buttonLabel_githubSrc
                else button.style.display = 'none' // hide Dismiss button
            }
        }))
    }

    // Define FEEDBACK functions

    function notify(msg, position = '', notifDuration = '', shadow = '') {
        chatgpt.notify(`${ config.appSymbol } ${ msg }`, position, notifDuration,
            shadow || ( isDarkMode() ? '' : 'shadow'))
    }

    function alert(title = '', msg = '', btns = '', checkbox = '', width = '') {
        return chatgpt.alert(`${ config.appSymbol } ${ title }`, msg, btns, checkbox, width )}

    const googleGPTconsole = {
        info: function(msg) { console.info(config.appSymbol + ' GoogleGPT >> ' + msg) },
        error: function(msg) { console.error(config.appSymbol + ' GoogleGPT >> ERROR: ' + msg) }
    }

    function googleGPTalert(msg) {
        if (msg.includes('login')) deleteOpenAIcookies()
        googleGPTdiv.innerHTML = (
            /waiting|loading/i.test(msg) ? // if alert involves loading, add class
                '<p class="loading">' : '<p>') + googleGPTalerts[msg]
            + (googleGPTalerts[msg].includes('@') ? // if msg needs login link, add it
                '<a href="https://chat.openai.com" target="_blank" rel="noopener">chat.openai.com</a> '
                    + '(' + messages.alert_ifIssuePersists + ')</p>' : '</p>')
    }

    // Define UI function

    function isDarkMode() { return document.querySelector('[data-darkmode="true"]') }

    // Define SESSION functions

    function isBlockedbyCloudflare(resp) {
        try {
            const html = new DOMParser().parseFromString(resp, 'text/html'),
                  title = html.querySelector('title')
            return title.innerText === messages.alert_justAmoment + '...'
        } catch (err) { return false }
    }

    function deleteOpenAIcookies() {
        if (getUserscriptManager() !== 'Tampermonkey') return
        GM_cookie.list({ url: openAIendpoints.auth }, (cookies, error) => {
            if (!error) { for (const cookie of cookies) {
                GM_cookie.delete({ url: openAIendpoints.auth, name: cookie.name })
    }}})}

    function getOpenAItoken() {
        return new Promise((resolve) => {
            const accessToken = GM_getValue(config.prefix + '_openAItoken')
            googleGPTconsole.info('OpenAI access token: ' + accessToken)
            if (!accessToken) {
                GM.xmlHttpRequest({ url: openAIendpoints.session, onload: (response) => {
                    if (isBlockedbyCloudflare(response.responseText)) {
                        googleGPTalert('checkCloudflare') ; return }
                    try {
                        const newAccessToken = JSON.parse(response.responseText).accessToken
                        GM_setValue(config.prefix + '_openAItoken', newAccessToken)
                        resolve(newAccessToken)
                    } catch { googleGPTalert('login') ; return }
                }})
            } else resolve(accessToken)
    })}

    function getAIGCFkey() {
        return new Promise((resolve) => {
            const publicKey = GM_getValue(config.prefix + '_aigcfKey')
            if (!publicKey) {
                GM.xmlHttpRequest({ method: 'GET', url: 'https://api.aigcfun.com/fc/key',
                    headers: {
                        'Content-Type': 'application/json',
                        'Referer': 'https://aigcfun.com/',
                        'X-Forwarded-For': chatgpt.generateRandomIP() },
                    onload: (response) => {
                        const newPublicKey = JSON.parse(response.responseText).data
                        if (!newPublicKey) { googleGPTconsole.error('Failed to get AIGCFun public key') ; return }
                        GM_setValue(config.prefix + '_aigcfKey', newPublicKey)
                        console.info('AIGCFun public key set: ' + newPublicKey)
                        resolve(newPublicKey)
                }})
            } else resolve(publicKey)
    })}

    // Define ANSWER functions

    async function getShowReply(convo, callback) {

        // Initialize attempt properties
        if (!getShowReply.triedEndpoints) getShowReply.triedEndpoints = []
        if (!getShowReply.attemptCnt) getShowReply.attemptCnt = 0

        // Pick API
        let endpoint, accessKey, model
        if (config.proxyAPIenabled) { // randomize proxy API
            const untriedEndpoints = proxyEndpoints.filter((entry) => {
                return !getShowReply.triedEndpoints?.includes(entry[0]) })
            const entry = untriedEndpoints[Math.floor(chatgpt.randomFloat() * untriedEndpoints.length)]
            endpoint = entry[0] ; accessKey = entry[1] ; model = entry[2]
        } else { // use OpenAI API
            endpoint = openAIendpoints.chat
            const timeoutPromise = new Promise((resolve, reject) => {
                setTimeout(() => { reject(new Error('Timeout occurred')) }, 3000) })
            accessKey = await Promise.race([getOpenAItoken(), timeoutPromise])
            if (!accessKey) { googleGPTalert('login') ; return }
            model = 'text-davinci-002-render'
        }

        // Get answer from ChatGPT
        const data = JSON.stringify(
            config.proxyAPIenabled ? { messages: convo, model: model }
                                   : { action: 'next', messages: convo, model: model,
                                       parent_message_id: chatgpt.uuidv4(), max_tokens: 4000 })
        GM.xmlHttpRequest({
            method: 'POST', url: endpoint,
            headers: { 'Content-Type': 'application/json', Authorization: 'Bearer ' + accessKey },
            responseType: responseType(), data: data, onloadstart: onLoadStart(), onload: onLoad(),
            onerror: (err) => {
                googleGPTconsole.error(err)
                if (!config.proxyAPIenabled) googleGPTalert(!accessKey ? 'login' : 'suggestProxy')
                else { // if proxy mode
                    if (getShowReply.attemptCnt < proxyEndpoints.length) retryDiffHost()
                    else googleGPTalert('suggestOpenAI')
            }}
        })

        function responseType() {
            return (!config.proxyAPIenabled && getUserscriptManager() === 'Tampermonkey') ? 'stream' : 'text' }

        function retryDiffHost() {
            googleGPTconsole.error(`Error calling ${ endpoint }. Trying another endpoint...`)
            getShowReply.triedEndpoints.push(endpoint) // store current proxy to not retry
            getShowReply.attemptCnt++
            getShowReply(convo, callback)
        }

        function onLoadStart() { // process streams for unproxied TM users
            googleGPTconsole.info('Endpoint used: ' + endpoint)
            if (!config.proxyAPIenabled && getUserscriptManager() === 'Tampermonkey') {
                return (stream) => {
                    const reader = stream.response.getReader()
                    reader.read().then(function processText({ done, value }) {
                        if (done) return
                        let responseItem = String.fromCharCode(...Array.from(value))
                        const items = responseItem.split('\n\n')
                        if (items.length > 2) {
                            const lastItem = items.slice(-3, -2)[0]
                            if (lastItem.startsWith('data: [DONE]')) responseItem = items.slice(-4, -3)[0]
                            else responseItem = lastItem
                        }
                        if (responseItem.startsWith('data: {')) {
                            const answer = JSON.parse(responseItem.slice(6)).message.content.parts[0]
                            googleGPTshow(answer)
                        } else if (responseItem.startsWith('data: [DONE]')) return
                        return reader.read().then(processText)
        })}}}

        function onLoad() {
            return (event) => {
                if (event.status !== 200) {
                    googleGPTconsole.error('Event status: ' + event.status)
                    googleGPTconsole.error('Event response: ' + event.responseText)
                    if (config.proxyAPIenabled && getShowReply.attemptCnt < proxyEndpoints.length)
                        retryDiffHost()
                    else if (event.status === 401 && !config.proxyAPIenabled) {
                        GM_deleteValue(config.prefix + '_openAItoken') ; googleGPTalert('login') }
                    else if (event.status === 403)
                        googleGPTalert(config.proxyAPIenabled ? 'suggestOpenAI' : 'checkCloudflare')
                    else if (event.status === 429) googleGPTalert('tooManyRequests')
                    else googleGPTalert(config.proxyAPIenabled ? 'suggestOpenAI' : 'suggestProxy')
                } else if (!config.proxyAPIenabled && getUserscriptManager() !== 'Tampermonkey') {
                    if (event.response) {
                        try { // to parse txt response from OpenAI endpoint for non-TM users
                            const responseParts = event.response.split('\n\n'),
                                  finalResponse = JSON.parse(responseParts[responseParts.length - 4].slice(6)),
                                  answer = finalResponse.message.content.parts[0]
                            googleGPTshow(answer)
                        } catch (err) {
                            googleGPTconsole.error(googleGPTalerts.parseFailed + ': ' + err)
                            googleGPTconsole.error('Response: ' + event.response)
                            googleGPTalert('suggestProxy')
                        }
                    }
                } else if (config.proxyAPIenabled) {
                    if (event.responseText) {
                        try { // to parse txt response from proxy endpoints
                            const answer = JSON.parse(event.responseText).choices[0].message.content
                            googleGPTshow(answer) ; getShowReply.triedEndpoints = [] ; getShowReply.attemptCnt = 0
                        } catch (err) {
                            googleGPTconsole.info('Response: ' + event.responseText)
                            if (event.responseText.includes('éžå¸¸æŠ±æ­‰ï¼Œæ ¹æ®æˆ‘ä»¬çš„äº§å“è§„åˆ™ï¼Œæ— æ³•ä¸ºä½ æä¾›è¯¥é—®é¢˜çš„å›žç­”'))
                                googleGPTshow(messages.alert_censored)
                            else if (event.responseText.includes('ç»´æŠ¤'))
                                googleGPTshow(messages.alert_maintenance + '. ' + messages.alert_suggestOpenAI)
                            else if (event.responseText.includes('finish_reason')) { // if other AIGCF error encountered
                                GM_setValue(config.prefix + '_aigcfKey', false) // clear GM key for fresh getAIGCFkey()

                                // Determine index of AIGCF in endpoint map
                                let aigcfMapIndex = -1
                                for (let i = 0 ; i < proxyEndpoints.length ; i++) {
                                    const endpoint = proxyEndpoints[i]
                                    if (endpoint.some(item => item.includes('aigcfun'))) {
                                        aigcfMapIndex = i ; break
                                }}

                                // Updated AIGCF endpoint w/ fresh key (using fresh IP)
                                (async () => { // IIFE to use await
                                    proxyEndpoints[aigcfMapIndex][0] = (
                                        'https://api.aigcfun.com/api/v1/text?key=' + await getAIGCFkey())
                                    getShowReply(convo, callback) // re-fetch reply
                                })()

                            } else { // use different endpoint or suggest OpenAI
                                googleGPTconsole.error(googleGPTalerts.parseFailed + ': ' + err)
                                if (getShowReply.attemptCnt < proxyEndpoints.length) retryDiffHost()
                                else googleGPTalert('suggestOpenAI')
                            }
                        }
        }}}}
    }

    function googleGPTshow(answer) {
        googleGPTdiv.innerHTML = '<p><span class="prefix">ðŸ¤–  <a href="https://googlegpt.kudoai.com" target="_blank" rel="noopener">GoogleGPT</a></span><span class="kudo-ai">by <a target="_blank" href="https://github.com/kudoai" rel="noopener">KudoAI</a></span><span class="balloon-tip"></span><pre></pre></p><div></div><section><form><div class="continue-chat"><textarea id="googlegpt-reply-box" rows="1" placeholder="Send reply..."></textarea></div></form></section>'
        googleGPTdiv.querySelector('pre').textContent = answer

        // Render math
        renderMathInElement(googleGPTdiv.querySelector('pre'), { // eslint-disable-line no-undef
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true },
                { left: '\\begin{equation}', right: '\\end{equation}', display: true },
                { left: '\\begin{align}', right: '\\end{align}', display: true },
                { left: '\\begin{alignat}', right: '\\end{alignat}', display: true },
                { left: '\\begin{gather}', right: '\\end{gather}', display: true },
                { left: '\\begin{CD}', right: '\\end{CD}', display: true },
                { left: '\\[', right: '\\]', display: true }
            ],
            throwOnError: false
        })

        // Init variables for listeners
        const form = googleGPTdiv.querySelector('form'),
              replyBox = document.getElementById('googlegpt-reply-box'),
              { paddingTop, paddingBottom } = getComputedStyle(replyBox),
              vOffset = parseInt(paddingTop, 10) + parseInt(paddingBottom, 10)
        let prevLength = replyBox.value.length

        // Add listeners
        form.addEventListener('keydown', enterToSubmit)
        replyBox.addEventListener('input', autosizeBox)

        function enterToSubmit(event) {
            if (event.key === 'Enter' && event.target.nodeName === 'TEXTAREA') handleSubmit(event) }

        function handleSubmit(event) {
            event.preventDefault()
            if (convo.length > 2) convo.splice(0, 2) // keep token usage maintainable
            const prevReplyTrimmed = googleGPTdiv.querySelector('pre').textContent.substring(0, 250 - replyBox.value.length),
                  yourReply = replyBox.value + ' / Answer in ' + config.replyLanguage
            if (!config.proxyAPIenabled) {
                convo.push({ role: 'assistant', id: chatgpt.uuidv4(), content: { content_type: 'text', parts: [prevReplyTrimmed] } })
                convo.push({ role: 'user', id: chatgpt.uuidv4(), content: { content_type: 'text', parts: [yourReply] } })
            } else {
                convo.push({ role: 'assistant', content: prevReplyTrimmed })
                convo.push({ role: 'user', content: yourReply })
            } getShowReply(convo)

            // Remove listeners since they're re-added
            replyBox.removeEventListener('input', autosizeBox)
            replyBox.removeEventListener('keydown', enterToSubmit)

            // Show loading status
            const replySection = googleGPTdiv.querySelector('section')
            replySection.classList.add('loading')
            replySection.innerHTML = googleGPTalerts.waitingResponse
        }

        function autosizeBox() {
            const newLength = replyBox.value.length
            if (newLength < prevLength) { // if deleting txt
                replyBox.style.height = 'auto' // ...auto-fit height
                if (parseInt(getComputedStyle(replyBox).height) < 35) { // if down to one line
                    replyBox.style.height = '1.55rem' } // ...reset to original height
            }
            replyBox.style.height = replyBox.scrollHeight - vOffset + 'px'
            prevLength = newLength
        }
    }

    async function loadGoogleGPT() {
        googleGPTalert('waitingResponse')
        const hostContainer = (
            document.querySelector('#center_col + div > div') ||
                (() => {
                    const centerCol = document.querySelector('#center_col'),
                          newDiv = document.createElement('div')
                    centerCol.style.paddingRight = '45px'
                    newDiv.style.display = 'contents'
                    centerCol.insertAdjacentElement('afterend', newDiv)
                    return newDiv
                })()
		)
        hostContainer.prepend(googleGPTdiv)
        const query = new URL(location.href).searchParams.get('q') + ' / Answer in ' + config.replyLanguage
        convo.push(
            config.proxyAPIenabled ? { role: 'user', content: query }
                                   : { role: 'user', id: chatgpt.uuidv4(),
                                       content: { content_type: 'text', parts: [query] }})
        getShowReply(convo)
    }

    // Run MAIN routine

    // Init config/convo/menu
    const config = {
        prefix: 'googlegpt', appSymbol: 'ðŸ¤–', userLanguage: chatgpt.getUserLanguage(),
        gitHubURL: 'https://github.com/userscripts/googlegpt',
        greasyForkURL: '' }
    config.updateURL = config.greasyForkURL + '/code/GoogleGPT.meta.js'
    config.assetHostURL = 'https://raw.githubusercontent.com/adamlui/userscripts/master/chatgpt/googlegpt/'
    loadSetting('proxyAPIenabled', 'prefixEnabled', 'replyLanguage', 'fatterSidebar', 'suffixEnabled')
    if (!config.replyLanguage) saveSetting('replyLanguage', config.userLanguage) // init reply language if unset
    const convo = []

    // Exit if prefix/suffix required but not present
    if (( config.prefixEnabled && !/.*q=%2F/.test(document.location) ) || // if prefix required but not present
        ( config.suffixEnabled && !/.*q=.*%3F(&|$)/.test(document.location) )) { // or suffix required but not present
            return }

    // Define messages
    const msgsLoaded = new Promise(resolve => {
        const msgHostDir = config.assetHostURL + '_locales/',
              msgLocaleDir = ( config.userLanguage ? config.userLanguage.replace('-', '_') : 'en' ) + '/'
        let msgHref = msgHostDir + msgLocaleDir + 'messages.json', msgXHRtries = 0
        GM.xmlHttpRequest({ method: 'GET', url: msgHref, onload: onLoad })
        function onLoad(response) {
            try { // to return localized messages.json
                const messages = new Proxy(JSON.parse(response.responseText), {
                    get(target, prop) { // remove need to ref nested keys
                        if (typeof target[prop] === 'object' && target[prop] !== null && 'message' in target[prop]) {
                            return target[prop].message
                }}}) ; resolve(messages)
            } catch (err) { // if 404
                msgXHRtries++ ; if (msgXHRtries == 3) return // try up to 3X (original/region-stripped/EN) only
                msgHref = config.userLanguage.includes('-') && msgXHRtries == 1 ? // if regional lang on 1st try...
                    msgHref.replace(/(.*)_.*(\/.*)/, '$1$2') // ...strip region before retrying
                        : ( msgHostDir + 'en/messages.json' ) // else use default English messages
                GM.xmlHttpRequest({ method: 'GET', url: msgHref, onload: onLoad })
            }
        }
    }) ; const messages = await msgsLoaded

    registerMenu()

    // Init endpoints
    const openAIendpoints = {
        session: 'https://chat.openai.com/api/auth/session',
        auth: 'https://auth0.openai.com',
        chat: 'https://chat.openai.com/backend-api/conversation' }
    const proxyEndpoints = [[ 'https://api.aigcfun.com/api/v1/text?key=' + await getAIGCFkey(), '', 'gpt-3.5-turbo' ]]

    // Init alerts
    const googleGPTalerts = {
        waitingResponse: messages.alert_waitingResponse + '...',
        login: messages.alert_login + ' @ ',
        tooManyRequests: messages.alert_tooManyRequests + '. '
            + messages['alert_suggest' + ( config.proxyAPIenabled ? 'OpenAI' : 'Proxy' )],
        parseFailed: messages.alert_parseFailed + '. '
            + messages['alert_suggest' + ( config.proxyAPIenabled ? 'OpenAI' : 'Proxy' )],
        checkCloudflare: messages.alert_checkCloudflare + ' @ ',
        suggestProxy: messages.alert_openAInotWorking + '. ' + messages.alert_suggestProxy,
        suggestOpenAI: messages.alert_proxyNotWorking + '. ' + messages.alert_suggestOpenAI
    }

    // Stylize elements
    const googleGPTstyle = document.createElement('style')
    googleGPTstyle.innerText = (
        '.googlegpt-container { border-radius: 8px ; border: 1px solid #dadce0 ; padding: 16px 26px ; flex-basis: 0 ;'
            + 'flex-grow: 1 ; word-wrap: break-word ; white-space: pre-wrap ; box-shadow: 0 2px 3px rgba(0, 0, 0, 0.06) ; '
            + 'margin: 0 0 30px 20px ; height: fit-content;'
            + ( isDarkMode() ? ' border: none ; background: #282828 } ' : ' } ' )
        + '.googlegpt-container p { margin: 0 ; ' + ( isDarkMode() ? 'color: #ccc } ' : ' } ' )
        + ( isDarkMode() ? '.googlegpt-container a { text-decoration: underline }' : '' ) // underline dark-mode links in alerts
        + '.googlegpt-container .prefix { font-size: 1.5rem ; font-weight: 700 }'
        + '.googlegpt-container .prefix > a { color: ' + ( isDarkMode() ? 'white' : 'inherit' ) + ' ; text-decoration: none }'
        + '.googlegpt-container .loading {'
            + 'color: #b6b8ba ; animation: pulse 2s cubic-bezier(.4,0,.6,1) infinite ;'
            + '-webkit-user-select: none ; -moz-user-select: none ; -ms-user-select: none ; user-select: none }'
        + '.googlegpt-container.sidebar-free { margin-left: 60px ; height: fit-content }'
        + '.googlegpt-container pre { font-size: 1.14rem ; white-space: pre-wrap ; min-width: 0 ; margin: 16px 0 0 0 ; line-height: 22px ; padding: 1.25em ; border-radius: 10px ;'
            + ( isDarkMode() ? 'background: #3a3a3a ; color: #f2f2f2 } ' : 'background: #eaeaea } ' )
        + '@keyframes pulse { 0%, to { opacity: 1 } 50% { opacity: .5 }}'
        + '.googlegpt-container section.loading {'
            + 'padding: 15px 0 0 5px ;' // left/top-pad loading status when sending replies
            + '-webkit-user-select: none ; -moz-user-select: none ; -ms-user-select: none ; user-select: none }'
        + '.chatgpt-feedback { margin: 2px 0 25px }'
        + '.balloon-tip { content: "" ; position: relative ; top: 5px ; right: 15.9em ; border: 7px solid transparent ;'
            + 'border-bottom-style: solid ; border-bottom-width: 1.19rem ; border-top: 0 ; border-bottom-color: '
            + ( isDarkMode() ? '#3a3a3a' : '#eaeaea' ) + ' } '
        + '.continue-chat > textarea {'
            + 'border: none ; border-radius: 12px 13px 12px 0 ; '
            + 'height: 1.55rem ; width: 97.6% ; max-height: 200px ;resize: none ; '
            + 'margin: 13px 0 15px 0 ; padding: 13px 0 2px 10px ; '
            + 'background: ' + ( isDarkMode() ? '#515151' : '#eeeeee70' ) + ' } '
        + '.kudo-ai { position: relative ; left: 6px ; color: #aaa } '
        + '.kudo-ai a, .kudo-ai a:visited { color: #aaa ; text-decoration: none } '
        + '.kudo-ai a:hover { color: ' + ( isDarkMode() ? 'white' : 'black' ) + ' ; text-decoration: none } '
        + '.katex-html { display: none } ' // hide unrendered math
        + '.chatgpt-modal h2 { margin: 0 ; padding: 0 } ' // shrink margin/padding around update alert title
        + '.chatgpt-modal p { margin: -8px 0 -9px 4px ; font-size: 1.55rem } ' // position/size update alert msg
        + '.chatgpt-modal button { ' // chatgpt.alert() buttons
            + 'padding: 8px 15px !important ; cursor: pointer ; border-radius: 0 !important ; '
            + 'text-transform: uppercase ; border: 2px solid black !important } '
        + '.chatgpt-modal button:hover { color: white !important } ' // color text white on update alert button hovers
        + '.chatgpt-modal div[class*=checkbox] label { position: relative ; bottom: -0.1857rem ; left: -2px } ' // position skip update checkbox
    )
    document.head.appendChild(googleGPTstyle) // append style to <head>

    // Create DDGPT container & add class
    const googleGPTdiv = document.createElement('div') // create container div
    googleGPTdiv.className = 'googlegpt-container'

    // Create feedback footer & add classes/HTML
    const googleGPTfooter = document.createElement('div')
    googleGPTfooter.className = 'feedback-prompt chatgpt-feedback'
    googleGPTfooter.innerHTML = '<a href="https://github.ddgpt.com/discussions/new/choose"'
        + ' class="feedback-prompt__link" target="_blank" rel="noopener">' + messages.link_shareFeedback +'</a>'

    loadGoogleGPT()

})()
